<templates>
    <div id="main-tmp">

    </div>
    <div id="path-tmp">
        <div >
            <input type="button" value="&nbsp;+&nbsp;" class="fs-04 " onclick="path_new();" />
            <input type="button" value="&nbsp;×&nbsp;" class="fs-04 c-ired" onclick="this.parentNode.parentNode.removeChild(this.parentNode); pathHelper();" />
            <input id="path-path" type="text" value="M 35.355339,158.58375 C 55.54984,106.78976 87.063718,64.051262 147.48227,44.436508" class="c-t-iblack w-02" />
            <input id="path-pointLength" type="text" value="80" class="c-t-iblack w-01" />.
            <input type="button" value="&nbsp;active&nbsp;" class="fs-04 " onclick="css_r(this.parentNode.parentNode.childNodes, 'act'); css(this.parentNode, 'act'); path_load(); pathHelper();" />
            <input type="button" value="&nbsp;apply&nbsp;" class="fs-04 " onclick="css_r(this.parentNode.parentNode.childNodes, 'act'); css(this.parentNode, 'act'); path_build(); pathHelper();" /> 
        </div>
    </div>
    <script>
        function home() {
            get('cntr').innerHTML = get('main-tmp').innerHTML;
        }
        home();
    </script>
</templates>
<panels>
    <div id="point-panel" class="ab l-00 r-00 t-00 p-005 z10 ns">
        <div class="menu  f f-js f-r f-ct f-ae f-st cgray c-t-iwhite">
            <input type="button" class="fs-04 c-i-hred" value="&nbsp;×&nbsp;" onclick="get('point-panel').classList._add('hdn')" />
            <a onclick="selTab(this)" class="c-t-iwhite ml-005 sel"> Point Struct </a>
            <img class="w-01 h-01 op2 c-h-itrans" src="/images/shapes/sep.svg" />
            <a onclick="selTab(this)">paths    </a>
            <a onclick="selTab(this)">Restriction      </a>
            <a onclick="selTab(this)">Cut-Join </a>
            <a onclick="selTab(this)">Custom   </a>
            <img class="w-01 h-01 op2 c-h-itrans" src="/images/shapes/sep.svg" />
            <input type="button" value="source" />
        </div>
        <div class="ctrdark h-mn-04  h-mn-08 sub-f p-0025">
            <div id="Point-Struct">points</div>
            <div id="paths" class="f f-r f-w f-jb f-as f-ct f-st w-full">
                <div class=" f-i01" id="paths_list">
                    <input type="button" value="new path" onclick="path_new();" />
                </div>
                <div class="f-i11  c-itrdark ns bl-i-0025 c-b-iorg">
                    <div class="menu  f f-js f-r f-ct f-ae f-st cgray c-t-iwhite ">
                        <a onclick="selTab(this)">Push    </a>
                        <a onclick="selTab(this)">Density</a>
                    </div>
                    <div class="ctrdark h-mn-04 sub-f p-0025 show">
                        <div id="Push">
                            <textarea cols="60" rows="10" class="owf-x w-p80  c-t-iblack " id="path-push">r.push({x:-n.x+100.0,y:0.0,z:n.y-100})</textarea>
                        </div>
                        <div id="Density">
                            <textarea cols="60" rows="10" class="owf-x  w-p80  c-t-iblack" id="path-density">[1,1,1,1,1]</textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Restriction">Restriction</div>
            <div id="Cut-Join">Cut-Join</div>
            <div id="Custom">Custom</div>
        </div>
    </div>

    <script>
        function selTab(th) {
            all('a', function (it, i) { if (def(it.classList)) it.classList.remove('sel'); }, function () { th.classList._add('sel'); }, null, th.parentNode);
            all('.sub-f > div', function (it, i) { if (def(it.classList)) it.classList.remove('sel-f'); }, function () {
                get(th.innerText.trim().replaceAll(' ', '-')).classList._add('sel-f');
            }, null, th.parentNode.parentNode);
        }
    </script>
</panels>
<menu>
    <div class="menu ab l-00 r-00 b-00 p-005 z10 f f-jb f-r f-ct f-ae f-st c-htrdark ">
        <img class="w-01 h-01" src="/images/shapes/menu.svg" />
        <img class="w-01 h-01 op2 c-h-itrans" src="/images/shapes/sep.svg" />
        <img class="w-01 h-01" src="/images/shapes/newPoint.svg" />

        <div id="cntr" class=" w-full f f-js f-r f-ct f-as f-st   ">
        </div>
    </div>
</menu>
<engine>
    <div class="ab w-full h-full t-i-00 b-i-00 z05">
        <canvas id="renderCanvas" class=" cwhite w-full h-full"></canvas>
    </div>
    <div id="shaders" class="hdn"></div>

    <script src="/contents/scripts/engine/babylon.js"></script>
    <script src="/contents/scripts/engine/three.js"></script>
    <script src="/contents/scripts/3dbase.js"></script>
    <script src="/contents/scripts/3dbase_initialize_babylonJs.js"></script>
    <script src="/contents/scripts/3dMaterial.js"></script>
    <script src="/contents/scripts/3dtools.js"></script>
    <script src="/contents/scripts/tools/dev.js"></script>


    <script type="text/javascript">
        var eng1, eng2, b = [], b2, ix = 0, iy = 0, iz = 0;
        var helpers = [];
        eng1 = new $3d({ engine: createBabylonJsEngine(), geometry: createBabylonJsGeometry(), material: createBabylonJsMaterial() });
        eng1.engine.instance.canvas = document.getElementById('renderCanvas');
        var bx, bx1, phi = 0, theta = 0;
        var time = 0;
        eng1.engine.onRequestFrame = function () {

            time += 0.06;
            _for(b, function (it, i) {

                if (def(it)) {
                    it.material.setVector3("camera", eng1.get().cameras.main.position);
                    it.material.setFloat("time", time);
                }

            });

        };

        eng1.engine.onInitScene = function () {

            var w = new $3d.tools.surface({
                paths: [[{ x: -10000, y: -10, z: -10000 }, { x: 10000, y: -10, z: -10000 }], [{ x: -10000, y: -10, z: 10000 }, { x: 10000, y: -10, z: 10000 }]],
                //flip:true
            }).toMesh(eng1);
            //w2.material = mat();

            //var w = new BABYLON.Mesh.CreateBox('s', 30, eng1.get().scene);
            w.material = mat(mat_table());

            b.push(w);
        }
        eng1.start();





    </script>

</engine>