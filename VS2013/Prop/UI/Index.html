<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
    <link href="stylesheets/screen.css" rel="stylesheet" />
    <script src="scripts/prop/base.js"></script>
    <script src="scripts/prop/loader.js"></script>

    <!--3d-->
    <script src="/scripts/3dbase.js"></script>

    <script src="/scripts/prop/3d/engines/babylon.js"></script>
    <script src="/scripts/prop/3d/engines/three.js"></script>

    <script src="/scripts/3dbase_Initialize_BabylonJs.js"></script>
    <script src="/scripts/3dTools.js"></script>

    <script src="scripts/prop/3d/Shaders.js"></script>
</head>
<body class="owf">
    <!-- fit screen dom -->
    <div id="main" class="main ab w_f h_f owf dblue">
    </div>
    <!-- menu -->
    <div class="menu ab w_a h_a b00 r00 ">
        <img class="w01 h01 mr4 mb4 hblue" src="/images/shapes/panel.svg" />
        <img class="w01 h01 mr4 mb4 hblue" src="/images/shapes/menu.svg" onclick="addGeo()" />
    </div>
    <!-- popup content -->
    <div class="ab l04 t04 r04 b00 hdn"></div>
    <!-- initializer -->
    <script>
        var eng1, eng2, b = [], b2, ix = 0, iy = 0, iz = 0;

        prop.loader.get('3d/babylonjs', function (d) {
            document.getElementById('main').innerHTML += d;

            eng1 = new $3d({ engine: createBabylonJsEngine(), geometry: createBabylonJsGeometry() });

            eng1.engine.instance.canvas = document.getElementById('renderCanvas');

            eng1.engine.onRequestFrame = function () {
                if (def(b)) {
                    for (var i = 0; i < b.length; i++) {
                        b[i].rotation.x = ix - i*i/ 170.0;
                        b[i].rotation.y = iy - i*i/ 190.0;
                        b[i].rotation.z = iz - i*i/ 180.0;
                    }

                    ix += 0.041;
                    iy += 0.06;
                    iz += 0.013;
                }

            };
            eng1.engine.start();


            addtime();

        });
        var k = 5.;

        function addtime() {
            addGeo();
            if (k < 20.)
                setTimeout(function () { addtime(); }, 200);
        }


        function addGeo() {
            k += 0.1;
            b.push($3d.sampleGeo({
                p1: { x: -0.3, y: -0.3, z: k },
                p2: { x: 0.3, y: -0.3, z: k },
                p3: { x: -0.3, y: 0.3, z: k },
                p4: { x: 0.3, y: 0.3, z: k }
            }).toMesh(eng1));

            b[b.length - 1].material = new BABYLON.StandardMaterial('dd', eng1.engine.instance.scene);
            b[b.length - 1].material.diffuseColor = new BABYLON.Color3(255, 255, 255);
            b[b.length - 1].material.alpha = 1.0 - (k / 15);
            if (k > 10) b[b.length - 1].material.alpha *= 0.6;
        }
    </script>
    <!-- developer tools
         can remove in release version
         contents : status
    -->
    <div id="status" class="ab t01 l01 h06 op05 blue "></div>
</body>
</html>
