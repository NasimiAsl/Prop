<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
    <link href="stylesheets/screen.css" rel="stylesheet" />
    <script src="scripts/prop/base.js"></script>
    <script src="scripts/prop/loader.js"></script>

    <!--3d-->
    <script src="/scripts/3dbase.js"></script>

    <script src="/scripts/prop/3d/engines/babylon.js"></script>
    <script src="/scripts/prop/3d/engines/three.js"></script>

    <script src="/scripts/3dbase_Initialize_BabylonJs.js"></script>
    <script src="/scripts/3dTools.js"></script>

    <script src="scripts/prop/3d/Shaders.js"></script>
</head>
<body class="owf">
    <!-- fit screen dom -->
    <div id="main" class="main ab w_f h_f owf dblue">
    </div>
    <canvas id='renderCanvas2' class="ab w06 h06 l02 t02 sblue"></canvas>
    <!-- menu -->
    <div class="menu ab w_a h_a b00 r00 ">
        <img class="w01 h01 mr4 mb4 hblue" src="/images/shapes/panel.svg" />
        <img class="w01 h01 mr4 mb4 hblue" src="/images/shapes/menu.svg" onclick="  " />
    </div>
    <!-- popup content -->
    <div class="ab l04 t04 r04 b00 hdn"></div>
    <!-- initializer -->
    <script>
        var eng1, eng2, b = [], b2, ix = 0, iy = 0, iz = 0;

        prop.loader.get('3d/babylonjs', function (d) {
            document.getElementById('main').innerHTML += d;

            eng1 = new $3d({ engine: createBabylonJsEngine(), geometry: createBabylonJsGeometry() });

            eng1.engine.instance.canvas = document.getElementById('renderCanvas');

            eng1.engine.onRequestFrame = function () {
                if (def(b)) {
                    for (var i = 0; i < b.length; i++) {
                        b[i].rotation.x = ix - i * i / 170.0;
                        b[i].rotation.y = iy - i * i / 190.0;
                        b[i].rotation.z = iz - i * i / 180.0;
                    }

                    ix += 0.0041;
                    iy += 0.006;
                    iz += 0.0013;
                }

            };

            eng1.engine.onInitScene = function () {

                addGeo(30.0, 2.5, 2.5, eng1, b);
                addGeo2(15.0, eng1, b);

            }

            eng1.engine.start();

            eng2 = new $3d({ engine: createBabylonJsEngine(), geometry: createBabylonJsGeometry() });

            eng2.engine.instance.canvas = document.getElementById('renderCanvas2');

            eng2.engine.onInitScene = function () {

                var ca = [];
                addGeo(15.0, 5, 2.5, eng2, ca);
                ca[ca.length - 1].rotation.x += 90 * deg;
                ca[ca.length - 1].material.diffuseColor = new BABYLON.Color3(255, 0, 0);
            }
            eng2.engine.start();

        });



        function addGeo(z2, min, st, eng, b) {

            var m = "M 14.142136,181.31218 12.121831,14.131932 160.61425,13.121779 C 25.862499,77.969213 262.37025,156.93826 14.142136,181.31218 z";

            var pts = $3d.tools.svg.getpoints({ min: min, step: st, path: m, push: function (r, n) { r.push({ x: n.x - 100., y: z2, z: n.y - 100. }); } });

            b.push($3d.tools.wall({
                path: pts,
                left: function (p) { return true; },
                right: function (p) { return true; },
                top: function (p) { return true; },
                bottom: function (p) { return true; },
                lr: function (p) { return true; },
                closed: true,
            }).toMesh(eng));

            b[b.length - 1].scaling.x *= 0.3;
            b[b.length - 1].scaling.y *= 0.3;
            b[b.length - 1].scaling.z *= 0.3;


            b[b.length - 1].material = new BABYLON.StandardMaterial('dd', eng.engine.instance.scene);

        }
        function addGeo2(z2, eng, b) {

            var m = "M 14.142136,181.31218 12.121831,14.131932 160.61425,13.121779 C 25.862499,77.969213 262.37025,156.93826 14.142136,181.31218 z";

            var pts = $3d.tools.svg.getPointes_ex({ path: m, push: function (r, n) { r.push({ x: n.x - 100., y: z2, z: n.y - 100. }); } });

            pts[0].push({ x: 0.5, y: 0.5, z: 0.5 });

            var b1 = $3d.tools.svg.extrudeShape_ex({
                path: m, push: function (r, n) {r.push({ x: n.x - 100., y: n.z, z: n.y - 100. });}
            }).toMesh(eng1);

            b.push(b1);
            b[b.length - 1].scaling.x *= 0.3;
            b[b.length - 1].scaling.y *= 0.3;
            b[b.length - 1].scaling.z *= 0.3;

            b[b.length - 1].material = new BABYLON.StandardMaterial('dd', eng.engine.instance.scene);


            b.push($3d.tools.wall({
                path: pts[0],
                left: function (p) { return true; },
                right: function (p) { return true; },
                top: function (p) { return true; },
                bottom: function (p) { return true; },
                lr: function (p) { return true; },
                closed: true,
            }).toMesh(eng));

            b[b.length - 1].scaling.x *= 0.3;
            b[b.length - 1].scaling.y *= 0.3;
            b[b.length - 1].scaling.z *= 0.3;


            b[b.length - 1].material = new BABYLON.StandardMaterial('dd', eng.engine.instance.scene);

            b[b.length - 1].material.diffuseColor = new BABYLON.Color3(255, 255, 0);
        }

    </script>
    <!-- developer tools
         can remove in release version
         contents : status
    -->
    <div id="status" class="ab t01 l01 h06 op05 blue "></div>
</body>
</html>
